@import 'tailwindcss';

:root {
  /* Light mode background: warm beige (less bright than pure white). */
  --color-background: #f8f6f2;
  --color-foreground: #1d1c1a;
  --color-foreground-light: #4a4946;
  --color-muted: #dfddd6;
  /* Light surfaces (cards/hover): slightly darker beige for contrast. */
  --color-muted-light: #f1eeea;
  --color-muted-foreground: #888680;
  --color-primary: #d14424;
  --color-primary-foreground: #ffffff;
  --color-destructive: #ef4444;
  --color-destructive-dark: #d13e3e;
  --color-destructive-foreground: #ffffff;
  --color-success: #16a34a;
  --color-success-dark: #15803d;
  --color-success-foreground: #ffffff;
  --color-info: #0ea5e9;
  --color-info-dark: #0891b2;
  --color-info-foreground0: #ffffff;
  --color-code-background: rgb(40, 44, 52);
  --color-code-foreground: rgb(171, 178, 191);

  @media (prefers-color-scheme: dark) {
    --color-background: #1f1f1f;
    --color-foreground: #e8e8e8;
    --color-foreground-light: #a8a6a1;
    --color-muted: #3d3c3a;
    --color-muted-light: #2d2c2a;
    --color-muted-foreground: #a8a6a1;
  }
}

/* Accent palettes (color themes). Keep scheme (light/dark) separate. */
:root[data-color-theme='ember'] {
  --color-primary: #d14424;
  --color-primary-foreground: #ffffff;
}

:root[data-color-theme='ocean'] {
  --color-primary: #0077b6;
  --color-primary-foreground: #ffffff;
}

:root[data-color-theme='forest'] {
  --color-primary: #1f7a72;
  --color-primary-foreground: #ffffff;
}

:root[data-color-theme='violet'] {
  --color-primary: #6d28d9;
  --color-primary-foreground: #ffffff;
}

:root[data-color-theme='rose'] {
  --color-primary: #c84b6b;
  --color-primary-foreground: #ffffff;
}

@theme inline {
  --font-sans: 'DM Sans', sans-serif;
  --font-serif: 'Lora', serif;
  --font-mono: 'JetBrains Mono', monospace;
  --color-background: var(--color-background);
  --color-foreground: var(--color-foreground);
  --color-foreground-light: var(--color-foreground-light);
  --color-muted: var(--color-muted);
  --color-muted-light: var(--color-muted-light);
  --color-muted-foreground: var(--color-muted-foreground);
  --color-primary: var(--color-primary);
  --color-primary-foreground: var(--color-primary-foreground);
  --color-destructive: var(--color-destructive);
  --color-destructive-dark: var(--color-destructive-dark);
  --color-destructive-foreground: var(--color-destructive-foreground);
  --color-success: var(--color-success);
  --color-success-dark: var(--color-success-dark);
  --color-success-foreground: var(--color-success-foreground);
  --color-info: var(--color-info);
  --color-info-dark: var(--color-info-dark);
  --color-info-foreground: var(--color-info-foreground);
  --color-code-background: var(--color-code-background);
  --color-code-foreground: var(--color-code-foreground);
}

::-webkit-scrollbar {
  @apply w-2.5 bg-background;
}

::-webkit-scrollbar-track {
  @apply bg-background;
}

::-webkit-scrollbar-thumb {
  @apply bg-muted rounded-t-full rounded-b-full border-r-2 border-background;
}

::-webkit-scrollbar-button {
  @apply hidden;
}

::-webkit-scrollbar-corner {
  @apply bg-background;
}

body::selection {
  @apply bg-primary/10;
}

body {
  @apply antialiased font-sans;
  background-color: var(--color-background);
  color: var(--color-foreground);
}

input,
textarea,
div[contenteditable] {
  @apply caret-primary;
}

div[contenteditable] {
  @apply outline-none;
}

@utility prose {
  @apply font-serif;

  blockquote {
    @apply my-4 border-l-4 border-muted pl-4 !italic text-foreground-light;
  }

  /* Lists */
  ol,
  ul {
    @apply my-4;

    ol,
    ul {
      @apply my-1;
    }

    li {
      @apply my-1 ml-6;

      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      p {
        @apply my-1;
      }
    }
  }

  ol {
    @apply list-decimal;

    ol {
      @apply list-[lower-alpha];

      ol {
        @apply list-[lower-roman];
      }
    }

    li:has(ul) {
      list-style-type: none;
    }

    li:has(ol) {
      list-style-type: none;
    }
  }

  ul {
    @apply list-disc;

    li:has(ul) {
      list-style-type: none;
    }

    li:has(ol) {
      list-style-type: none;
    }

    ul {
      list-style-type: circle;

      ul {
        list-style-type: square;
      }
    }

    /* Checklist items */
    li {
      &.fw-checklist-item {
        @apply list-none relative ml-1 pl-6 outline-none;

        &:not(:has(ul)):not(:has(ol)):before {
          @apply content-[''] w-4 h-4 border border-muted rounded-sm absolute -left-0 top-1 cursor-pointer;
        }

        &.fw-checked {
          @apply line-through;

          &:before {
            @apply bg-primary border-primary;
          }

          &:after {
            content: '';
            cursor: pointer;
            border-color: var(--color-primary-foreground);
            border-style: solid;
            position: absolute;
            display: block;
            top: 10px;
            width: 5px;
            left: 5px;
            height: 10px;
            transform: translateY(-50%) rotate(45deg);
            border-width: 0 0.1em 0.1em 0;
          }
        }
      }
    }
  }

  /* Tables */

  table {
    @apply my-4 w-full table-auto border-collapse text-left text-sm border border-muted bg-background;

    caption {
      @apply mt-2 caption-bottom text-left text-sm/6;
    }

    /* Don't rely on thead/tbody/tfoot existing (Lexical may omit them, or insert colgroup). */
    tr:first-of-type > th,
    tr:first-of-type > td {
      @apply bg-muted-light text-sm font-semibold text-foreground;
    }

    th {
      @apply align-bottom;
    }

    td,
    th {
      @apply p-2 border border-muted relative align-top;

      .fw-table-cell-action {
        @apply absolute top-1 right-1 pointer-events-auto;
      }

      .fw-table-cell-action-button {
        @apply w-5 h-5 rounded-md border border-muted bg-background text-muted-foreground;
        @apply flex items-center justify-center;
        @apply hover:bg-muted-light;
        opacity: 0;
        pointer-events: none;
      }

      &:hover .fw-table-cell-action-button {
        opacity: 1;
        pointer-events: auto;
        cursor: pointer;
      }

      &:focus-within .fw-table-cell-action-button {
        opacity: 1;
        pointer-events: auto;
        cursor: pointer;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      p,
      ul,
      ol,
      pre {
        @apply my-0;
      }
    }
  }

  /* Inline code */
  code {
    @apply text-sm bg-primary/10 inline rounded-md px-1 py-0.5 text-primary;
  }

  /* Code blocks */
  .fw-content-root > code {
    @apply my-4 text-sm bg-code-background text-code-foreground block rounded-md p-4 caret-white;

    .fw-attr {
      color: rgb(152, 195, 121);
    }

    .fw-property {
      color: rgb(209, 154, 102);
    }

    .fw-selector {
      color: rgb(224, 108, 117);
    }

    .fw-function {
      color: rgb(97, 175, 239);
    }

    .fw-comment {
      color: rgb(92, 99, 112);
    }

    .fw-variable {
      color: rgb(198, 120, 221);
    }

    .fw-operator {
      color: rgb(97, 175, 239);
    }

    .fw-punctuation {
      color: rgb(171, 178, 191);
    }

    .fw-keyword {
      color: rgb(198, 120, 221);
    }

    &::selection {
      @apply bg-white/20;
    }
  }

  /* Typography */

  del {
    @apply line-through opacity-60;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply my-4 font-semibold empty:hidden;
  }

  h1 {
    @apply text-2xl;
  }

  h2 {
    @apply text-xl;
  }

  h3 {
    @apply text-lg;
  }

  h4 {
    @apply text-base;
  }

  h5 {
    @apply text-sm;
  }

  p {
    @apply my-4 empty:hidden leading-relaxed;
  }

  hr {
    @apply my-4 border-muted;
  }

  a {
    @apply text-primary underline;
  }

  pre {
    @apply my-4 whitespace-pre;
  }
}
